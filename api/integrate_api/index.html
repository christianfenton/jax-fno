
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Fourier Neural Operators written in JAX/Flax">
      
      
      
      
        <link rel="prev" href="../learn_api/">
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Integration (jax_fno.integrate) - JAX-FNO</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#integration-jax_fnointegrate" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="JAX-FNO" class="md-header__button md-logo" aria-label="JAX-FNO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            JAX-FNO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Integration (jax_fno.integrate)
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/christianfenton/jax-fno" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    christianfenton/jax-fno
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="JAX-FNO" class="md-nav__button md-logo" aria-label="JAX-FNO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    JAX-FNO
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/christianfenton/jax-fno" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    christianfenton/jax-fno
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/solving_heat_equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Solving the heat equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/learning_antiderivative/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learning an antiderivative operator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/integrate_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Understanding the ODE integrator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../learn_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learning (jax_fno.learn)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Integration (jax_fno.integrate)
  

    
  </span>
  
  

      </a>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="integration-jax_fnointegrate">Integration (jax_fno.integrate)<a class="headerlink" href="#integration-jax_fnointegrate" title="Permanent link">&para;</a></h1>
<p><code>jax_fno.integrate</code> provides time integration methods for PDEs of the form
$$ \frac{\partial y}{\partial t} = f(t, y). $$</p>


<div class="doc doc-object doc-function">


<h1 id="jax_fno.integrate.solve_ivp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">jax_fno</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">solve_ivp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">step_size</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span></code>

<a href="#jax_fno.integrate.solve_ivp" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">

        <p>Integrate dy/dt = fun(t, y, *args) over the time interval t_span.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fun</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Callable right-hand side of system dy/dt = fun(t, y, *args)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_span</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(t_start, t_end) time interval</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y0</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial condition</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="jax_fno.integrate.StepperProtocol (jax_fno.integrate.timesteppers.StepperProtocol)" href="#jax_fno.integrate.StepperProtocol">StepperProtocol</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time-stepping method instance (e.g., RK4(), BackwardEuler())</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>step_size</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time step size</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to fun (and jvp/jac if provided)</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>t_final</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Final time</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y_final</code></td>            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solution at t_end</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_fno.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_ivp</span><span class="p">,</span> <span class="n">RK4</span>

<span class="c1"># Define ODE: dy/dt = -k*y</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="n">y</span>

<span class="c1"># Solve with args</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">RK4</span><span class="p">(),</span> <span class="n">step_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="p">,))</span>
</code></pre></div></p>
<p>Example usage with an implicit method and user-defined parameters:
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_fno.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_ivp</span><span class="p">,</span> <span class="n">NewtonRaphson</span><span class="p">,</span> <span class="n">GMRES</span><span class="p">,</span> <span class="n">BackwardEuler</span>

<span class="c1"># Define ODE: dy/dt = -k*y</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="n">y</span>

<span class="c1"># Create linear solver</span>
<span class="n">linsolver</span> <span class="o">=</span> <span class="n">GMRES</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Create non-linear solver</span>
<span class="n">root_finder</span> <span class="o">=</span> <span class="n">NewtonRaphson</span><span class="p">(</span><span class="n">linsolver</span><span class="o">=</span><span class="n">linsolver</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Choose integration method</span>
<span class="n">method</span> <span class="o">=</span> <span class="n">BackwardEuler</span><span class="p">(</span><span class="n">root_finder</span><span class="o">=</span><span class="n">root_finder</span><span class="p">)</span>

<span class="c1"># Solve</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="p">,))</span>
</code></pre></div></p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/solve.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_ivp</span><span class="p">(</span>
    <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">t_span</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">y0</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">StepperProtocol</span><span class="p">,</span>
    <span class="n">step_size</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Array</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Integrate dy/dt = fun(t, y, *args) over the time interval t_span.</span>

<span class="sd">    Args:</span>
<span class="sd">        fun: Callable right-hand side of system dy/dt = fun(t, y, *args)</span>
<span class="sd">        t_span: (t_start, t_end) time interval</span>
<span class="sd">        y0: Initial condition</span>
<span class="sd">        method: Time-stepping method instance (e.g., RK4(), BackwardEuler())</span>
<span class="sd">        step_size: Time step size</span>
<span class="sd">        args: Additional arguments to pass to fun (and jvp/jac if provided)</span>

<span class="sd">    Returns:</span>
<span class="sd">        t_final: Final time</span>
<span class="sd">        y_final: Solution at t_end</span>

<span class="sd">    Example usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    import jax.numpy as jnp</span>
<span class="sd">    from jax_fno.integrate import solve_ivp, RK4</span>

<span class="sd">    # Define ODE: dy/dt = -k*y</span>
<span class="sd">    def fun(t, y, k):</span>
<span class="sd">        return -k * y</span>

<span class="sd">    # Solve with args</span>
<span class="sd">    y0 = jnp.array([1.0])</span>
<span class="sd">    t_span = (0.0, 2.0)</span>
<span class="sd">    k = 0.5</span>

<span class="sd">    t, y = solve_ivp(fun, t_span, y0, RK4(), step_size=0.01, args=(k,))</span>
<span class="sd">    ```</span>

<span class="sd">    Example usage with an implicit method and user-defined parameters:</span>
<span class="sd">    ```python</span>
<span class="sd">    import jax.numpy as jnp</span>
<span class="sd">    from jax_fno.integrate import solve_ivp, NewtonRaphson, GMRES, BackwardEuler</span>

<span class="sd">    # Define ODE: dy/dt = -k*y</span>
<span class="sd">    def fun(t, y, k):</span>
<span class="sd">        return -k * y</span>

<span class="sd">    # Create linear solver</span>
<span class="sd">    linsolver = GMRES(tol=1e-6, maxiter=20)</span>

<span class="sd">    # Create non-linear solver</span>
<span class="sd">    root_finder = NewtonRaphson(linsolver=linsolver, tol=1e-5, maxiter=50)</span>

<span class="sd">    # Choose integration method</span>
<span class="sd">    method = BackwardEuler(root_finder=root_finder)</span>

<span class="sd">    # Solve</span>
<span class="sd">    y0 = jnp.array([1.0])</span>
<span class="sd">    t_span = (0.0, 2.0)</span>
<span class="sd">    k = 0.5</span>
<span class="sd">    t, y = solve_ivp(fun, t_span, y0, method, step_size=0.01, args=(k,))</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">=</span> <span class="n">t_span</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cond_fn</span><span class="p">(</span><span class="n">carry</span><span class="p">):</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">carry</span>
        <span class="k">return</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">t_end</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">body_fn</span><span class="p">(</span><span class="n">carry</span><span class="p">):</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">carry</span>

        <span class="c1"># Adjust final step to hit t_end exactly</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">step_size</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">-</span> <span class="n">t</span><span class="p">))</span>

        <span class="n">y_next</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

        <span class="n">t_next</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">h</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">t_next</span><span class="p">,</span> <span class="n">y_next</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

    <span class="n">t_final</span><span class="p">,</span> <span class="n">y_final</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">while_loop</span><span class="p">(</span><span class="n">cond_fn</span><span class="p">,</span> <span class="n">body_fn</span><span class="p">,</span> <span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">t_final</span><span class="p">,</span> <span class="n">y_final</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h1 id="jax_fno.integrate.solve_with_history" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">jax_fno</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">solve_with_history</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">step_size</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#jax_fno.integrate.solve_with_history" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">

        <p>Integrate dy/dt = fun(t, y, *args) over the time interval t_span.</p>
<p>This function allows users to return intermediate states at times <code>t_eval</code>,
but is not compatible with JAX transformations. The integration is done in 
chunks by calling <code>solve_ivp</code>, where <code>solve_ivp</code> has been JIT-compiled.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fun</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Right-hand side function with signature (t, y, *args) -&gt; dydt</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_span</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(t_start, t_end) time interval</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y0</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial condition</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="jax_fno.integrate.StepperProtocol (jax_fno.integrate.timesteppers.StepperProtocol)" href="#jax_fno.integrate.StepperProtocol">StepperProtocol</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time-stepping method instance (e.g., RK4(), BackwardEuler())</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>step_size</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time step size for integration.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_eval</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Times at which to store the computed solution.
If None, returns only the initial and final states.
Must be sorted and lie within t_span.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to fun (and jvp/jac if provided)</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print progress information</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>t</code></td>            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of time points, shape (n_points,)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y</code></td>            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of solution values at times t, shape (n_points, *y0.shape)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jax_fno.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_with_history</span><span class="p">,</span> <span class="n">RK4</span>

<span class="c1"># Define ODE: dy/dt = -k*y</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="n">y</span>

<span class="c1"># Solve with args</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">solve_with_history</span><span class="p">(</span>
    <span class="n">fun</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">RK4</span><span class="p">(),</span> <span class="n">step_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="p">,)</span>
<span class="p">)</span>
</code></pre></div></p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/solve.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_with_history</span><span class="p">(</span>
    <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">t_span</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">y0</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">StepperProtocol</span><span class="p">,</span>
    <span class="n">step_size</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">t_eval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="n">Array</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Integrate dy/dt = fun(t, y, *args) over the time interval t_span.</span>

<span class="sd">    This function allows users to return intermediate states at times `t_eval`,</span>
<span class="sd">    but is not compatible with JAX transformations. The integration is done in </span>
<span class="sd">    chunks by calling `solve_ivp`, where `solve_ivp` has been JIT-compiled.</span>

<span class="sd">    Args:</span>
<span class="sd">        fun: Right-hand side function with signature (t, y, *args) -&gt; dydt</span>
<span class="sd">        t_span: (t_start, t_end) time interval</span>
<span class="sd">        y0: Initial condition</span>
<span class="sd">        method: Time-stepping method instance (e.g., RK4(), BackwardEuler())</span>
<span class="sd">        step_size: Time step size for integration.</span>
<span class="sd">        t_eval: Times at which to store the computed solution.</span>
<span class="sd">            If None, returns only the initial and final states.</span>
<span class="sd">            Must be sorted and lie within t_span.</span>
<span class="sd">        args: Additional arguments to pass to fun (and jvp/jac if provided)</span>
<span class="sd">        verbose: Print progress information</span>

<span class="sd">    Returns:</span>
<span class="sd">        t: Array of time points, shape (n_points,)</span>
<span class="sd">        y: Array of solution values at times t, shape (n_points, *y0.shape)</span>

<span class="sd">    Example usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    import jax.numpy as jnp</span>
<span class="sd">    from jax_fno.integrate import solve_with_history, RK4</span>

<span class="sd">    # Define ODE: dy/dt = -k*y</span>
<span class="sd">    def fun(t, y, k):</span>
<span class="sd">        return -k * y</span>

<span class="sd">    # Solve with args</span>
<span class="sd">    y0 = jnp.array([1.0])</span>
<span class="sd">    t_span = (0.0, 2.0)</span>
<span class="sd">    t_eval = jnp.linspace(0, 2, 5)</span>
<span class="sd">    k = 0.5</span>

<span class="sd">    t, y = solve_with_history(</span>
<span class="sd">        fun, t_span, y0, RK4(), step_size=0.01, t_eval=t_eval, args=(k,)</span>
<span class="sd">    )</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">=</span> <span class="n">t_span</span>

    <span class="c1"># Set up evaluation times</span>
    <span class="k">if</span> <span class="n">t_eval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Only save initial and final states</span>
        <span class="n">t_eval</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Validate t_eval</span>
        <span class="n">t_eval</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">jnp</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">t_eval</span> <span class="o">&lt;</span> <span class="n">t_start</span><span class="p">)</span> <span class="ow">or</span> <span class="n">jnp</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">t_eval</span> <span class="o">&gt;</span> <span class="n">t_end</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All values in t_eval must be within t_span&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">jnp</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;t_eval must be sorted in increasing order&quot;</span><span class="p">)</span>

        <span class="c1"># Ensure t_start is included</span>
        <span class="k">if</span> <span class="n">t_eval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">t_start</span><span class="p">:</span>
            <span class="n">t_eval</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t_start</span><span class="p">]),</span> <span class="n">t_eval</span><span class="p">])</span>

    <span class="n">n_steps_total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">t_end</span> <span class="o">-</span> <span class="n">t_start</span><span class="p">)</span> <span class="o">/</span> <span class="n">step_size</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">method_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solving with </span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Time: [</span><span class="si">{</span><span class="n">t_start</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">t_end</span><span class="si">}</span><span class="s2">], dt=</span><span class="si">{</span><span class="n">step_size</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;~</span><span class="si">{</span><span class="n">n_steps_total</span><span class="si">}</span><span class="s2"> total steps&quot;</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Evaluating at </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)</span><span class="si">}</span><span class="s2"> time points&quot;</span><span class="p">)</span>

    <span class="n">integrate_jit</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">solve_ivp</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fun&#39;</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">])</span>

    <span class="c1"># Integrate between consecutive evaluation points:</span>
    <span class="n">y_save</span> <span class="o">=</span> <span class="p">[</span><span class="n">y0</span><span class="p">]</span>
    <span class="n">t_save</span> <span class="o">=</span> <span class="p">[</span><span class="n">t_start</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y0</span>

    <span class="n">start_wallclock</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">t_i</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">t_eval</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">t_ip1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">t_eval</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">integrate_jit</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="p">(</span><span class="n">t_i</span><span class="p">,</span> <span class="n">t_ip1</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">step_size</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="n">t_save</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">y_save</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="n">t_arr</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">t_save</span><span class="p">)</span>
    <span class="n">y_arr</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">y_save</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">elapsed_wallclock</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_wallclock</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Completed in </span><span class="si">{</span><span class="n">elapsed_wallclock</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">n_steps_total</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">elapsed_wallclock</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> steps/s)&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">t_arr</span><span class="p">,</span> <span class="n">y_arr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="time-stepping-schemes">Time-stepping schemes<a class="headerlink" href="#time-stepping-schemes" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.ForwardEuler" class="doc doc-heading">
            <code>jax_fno.integrate.ForwardEuler</code>


<a href="#jax_fno.integrate.ForwardEuler" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flax.nnx.Module">Module</span></code></p>



        <p>Forward Euler method.</p>


<details class="discretisation" open>
  <summary>Discretisation</summary>
  <div class="arithmatex">\[ \frac{\partial y}{\partial t} \rightarrow
\frac{(y_{n+1} - y_n)}{h} = f(t_n, y_n) \]</div>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/timesteppers/explicit.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ForwardEuler</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Forward Euler method.</span>

<span class="sd">    Discretisation:</span>
<span class="sd">        $$ \\frac{\\partial y}{\\partial t} \\rightarrow</span>
<span class="sd">        \\frac{(y_{n+1} - y_n)}{h} = f(t_n, y_n) $$</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="n">t</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">y</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">h</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform a single Forward Euler step.</span>

<span class="sd">        Computes $$ y_{n+1} = y_n + h f(t_n, y_n, *args). $$</span>

<span class="sd">        Args:</span>
<span class="sd">            fun: Right-hand side of system dydt = f(t, y, *args).</span>
<span class="sd">            t: Current time. Type: 0-dimensional JAX array.</span>
<span class="sd">            y: Current solution.</span>
<span class="sd">            h: Time step size. Type: 0-dimensional JAX array.</span>
<span class="sd">            args: Additional arguments to pass to fun.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Solution at t + h.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.ForwardEuler.step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">step</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span></code>

<a href="#jax_fno.integrate.ForwardEuler.step" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Perform a single Forward Euler step.</p>
<p>Computes $$ y_{n+1} = y_n + h f(t_n, y_n, *args). $$</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fun</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Right-hand side of system dydt = f(t, y, *args).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current time. Type: 0-dimensional JAX array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current solution.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>h</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time step size. Type: 0-dimensional JAX array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to fun.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solution at t + h.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/timesteppers/explicit.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">h</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a single Forward Euler step.</span>

<span class="sd">    Computes $$ y_{n+1} = y_n + h f(t_n, y_n, *args). $$</span>

<span class="sd">    Args:</span>
<span class="sd">        fun: Right-hand side of system dydt = f(t, y, *args).</span>
<span class="sd">        t: Current time. Type: 0-dimensional JAX array.</span>
<span class="sd">        y: Current solution.</span>
<span class="sd">        h: Time step size. Type: 0-dimensional JAX array.</span>
<span class="sd">        args: Additional arguments to pass to fun.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Solution at t + h.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.RK4" class="doc doc-heading">
            <code>jax_fno.integrate.RK4</code>


<a href="#jax_fno.integrate.RK4" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flax.nnx.Module">Module</span></code></p>



        <p>Fourth (4th) order Runge-Kutta method.</p>
<p>Implements: StepperProtocol</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/timesteppers/explicit.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RK4</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fourth (4th) order Runge-Kutta method.</span>

<span class="sd">    Implements: StepperProtocol</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="n">t</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">y</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">h</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform a single RK4 step.</span>

<span class="sd">        Args:</span>
<span class="sd">            fun: Right-hand side of system dy/dt = f(t, y, *args).</span>
<span class="sd">            t: Current time.</span>
<span class="sd">            y: Current solution.</span>
<span class="sd">            h: Time step size.</span>
<span class="sd">            args: Additional arguments to pass to fun.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Solution at t + h.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">k2</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">k1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">k3</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">k2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">k4</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">k3</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">h</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.RK4.step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">step</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span></code>

<a href="#jax_fno.integrate.RK4.step" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Perform a single RK4 step.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fun</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Right-hand side of system dy/dt = f(t, y, *args).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current time.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current solution.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>h</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time step size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to fun.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solution at t + h.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/timesteppers/explicit.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">h</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a single RK4 step.</span>

<span class="sd">    Args:</span>
<span class="sd">        fun: Right-hand side of system dy/dt = f(t, y, *args).</span>
<span class="sd">        t: Current time.</span>
<span class="sd">        y: Current solution.</span>
<span class="sd">        h: Time step size.</span>
<span class="sd">        args: Additional arguments to pass to fun.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Solution at t + h.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k1</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">k1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">k3</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">k2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">k4</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">k3</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">h</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.BackwardEuler" class="doc doc-heading">
            <code>jax_fno.integrate.BackwardEuler</code>


<a href="#jax_fno.integrate.BackwardEuler" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flax.nnx.Module">Module</span></code></p>



        <p>Backward Euler time stepper.</p>


<details class="discretisation" open>
  <summary>Discretisation</summary>
  <div class="arithmatex">\[ \frac{\partial y}{\partial t} \rightarrow
\frac{(y_{n+1} - y_n)}{h} = f(t_{n+1}, y_{n+1}) \]</div>
</details>        <p>If neither jvp nor jac are provided, defaults to root-finding using
automatic differentiation with <code>jax.jvp</code>.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/timesteppers/implicit.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BackwardEuler</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Backward Euler time stepper.</span>

<span class="sd">    Discretisation:</span>
<span class="sd">        $$ \\frac{\\partial y}{\\partial t} \\rightarrow</span>
<span class="sd">        \\frac{(y_{n+1} - y_n)}{h} = f(t_{n+1}, y_{n+1}) $$</span>

<span class="sd">    If neither jvp nor jac are provided, defaults to root-finding using</span>
<span class="sd">    automatic differentiation with `jax.jvp`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">root_finder</span><span class="p">:</span> <span class="n">RootFinderProtocol</span> <span class="o">=</span> <span class="n">NewtonRaphson</span><span class="p">(),</span>
        <span class="n">jvp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">jac</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root_finder</span> <span class="o">=</span> <span class="n">root_finder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jvp</span> <span class="o">=</span> <span class="n">jvp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jac</span> <span class="o">=</span> <span class="n">jac</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_residual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="k">lambda</span> <span class="n">y_np1</span><span class="p">:</span> <span class="n">y_np1</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span> <span class="n">h</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y_np1</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_build_linearisation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return (jac_fn, jvp_fn) for the Jacobian J_f = I - h * df/dy.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jac</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Dense Jacobian supplied</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">jac_fn</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">-</span> <span class="n">h</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jac</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">jac_fn</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jvp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Matrix-free Jacobian supplied</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">jvp_fn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">v</span> <span class="o">-</span> <span class="n">h</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jvp</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">jvp_fn</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">jvp_autodiff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
            <span class="c1"># Fall back to automatic differentiation</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">df_v</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jvp</span><span class="p">(</span><span class="k">lambda</span> <span class="n">y_</span><span class="p">:</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,),</span> <span class="p">(</span><span class="n">v</span><span class="p">,))</span>
            <span class="k">return</span> <span class="n">v</span> <span class="o">-</span> <span class="n">h</span> <span class="o">*</span> <span class="n">df_v</span>

        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">jvp_autodiff</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">()):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Advance one backward Euler step.&quot;&quot;&quot;</span>

        <span class="c1"># If using a spectral solver, construct diagonal symbol (1 - h s(k))</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_finder</span><span class="p">,</span> <span class="s1">&#39;linsolver&#39;</span><span class="p">):</span>
            <span class="n">linsolver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_finder</span><span class="o">.</span><span class="n">linsolver</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">linsolver</span><span class="p">,</span> <span class="s1">&#39;eigvals&#39;</span><span class="p">):</span>
                <span class="n">linsolver</span><span class="o">.</span><span class="n">set_symbol</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">h</span> <span class="o">*</span> <span class="n">linsolver</span><span class="o">.</span><span class="n">eigvals</span><span class="p">)</span>

        <span class="n">residual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_residual</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

        <span class="c1"># cheap forward Euler guess</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="n">jac_fn</span><span class="p">,</span> <span class="n">jvp_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_linearisation</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_finder</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">jac_fn</span><span class="o">=</span><span class="n">jac_fn</span><span class="p">,</span> <span class="n">jvp_fn</span><span class="o">=</span><span class="n">jvp_fn</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.BackwardEuler.step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">step</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span></code>

<a href="#jax_fno.integrate.BackwardEuler.step" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Advance one backward Euler step.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/timesteppers/implicit.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">h</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">()):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Advance one backward Euler step.&quot;&quot;&quot;</span>

    <span class="c1"># If using a spectral solver, construct diagonal symbol (1 - h s(k))</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root_finder</span><span class="p">,</span> <span class="s1">&#39;linsolver&#39;</span><span class="p">):</span>
        <span class="n">linsolver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_finder</span><span class="o">.</span><span class="n">linsolver</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">linsolver</span><span class="p">,</span> <span class="s1">&#39;eigvals&#39;</span><span class="p">):</span>
            <span class="n">linsolver</span><span class="o">.</span><span class="n">set_symbol</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">h</span> <span class="o">*</span> <span class="n">linsolver</span><span class="o">.</span><span class="n">eigvals</span><span class="p">)</span>

    <span class="n">residual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_residual</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="c1"># cheap forward Euler guess</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="n">jac_fn</span><span class="p">,</span> <span class="n">jvp_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_linearisation</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_finder</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">jac_fn</span><span class="o">=</span><span class="n">jac_fn</span><span class="p">,</span> <span class="n">jvp_fn</span><span class="o">=</span><span class="n">jvp_fn</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.IMEX" class="doc doc-heading">
            <code>jax_fno.integrate.IMEX</code>


<a href="#jax_fno.integrate.IMEX" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flax.nnx.Module">Module</span></code></p>



        <p>Implicit-Explicit (IMEX) time-stepping scheme.</p>
<p>Splits the ODE into stiff (implicit) and non-stiff (explicit) parts:
    dy/dt = f_explicit(t, y) + f_implicit(t, y)</p>


<details class="the-scheme-advances-the-solution-in-two-steps" open>
  <summary>The scheme advances the solution in two steps</summary>
  <ol>
<li>Explicit step:  u* = u^n + h * f_explicit(t^n, u^n)</li>
<li>Implicit step:  u^{n+1} = u* + h * f_implicit(t^{n+1}, u^{n+1})</li>
</ol>
</details>

<details class="the-implicit-step-is-solved-via-root-finding" open>
  <summary>The implicit step is solved via root-finding</summary>
  <p>R(u^{n+1}) = u^{n+1} - u* - h * f_implicit(t^{n+1}, u^{n+1}) = 0</p>
</details>        <p>This formulation allows you to:
- Use high-order explicit methods (RK4, etc.) for the non-stiff terms
- Use implicit methods (BackwardEuler, etc.) for the stiff terms
- Avoid overly restrictive time step constraints from stiff terms</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">jax_fno.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">solve_ivp</span><span class="p">,</span> <span class="n">IMEX</span><span class="p">,</span> <span class="n">RK4</span><span class="p">,</span> <span class="n">BackwardEuler</span><span class="p">,</span>
    <span class="n">NewtonRaphson</span><span class="p">,</span> <span class="n">Spectral</span>
<span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">explicit_term</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">...</span>

<span class="k">def</span><span class="w"> </span><span class="nf">implicit_term</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">...</span>

<span class="c1"># Instantiate solver</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">IMEX</span><span class="p">(</span><span class="n">implicit</span><span class="o">=</span><span class="n">BackwardEuler</span><span class="p">(),</span> <span class="n">explicit</span><span class="o">=</span><span class="n">RK4</span><span class="p">())</span>

<span class="c1"># Define ODE as a dict</span>
<span class="n">ode</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;implicit&#39;</span><span class="p">:</span> <span class="n">implicit_term</span><span class="p">,</span> <span class="s1">&#39;explicit&#39;</span><span class="p">:</span> <span class="n">explicit_term</span><span class="p">}</span>

<span class="c1"># Solve</span>
<span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="n">step_size</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</code></pre></div>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/timesteppers/imex.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">IMEX</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implicit-Explicit (IMEX) time-stepping scheme.</span>

<span class="sd">    Splits the ODE into stiff (implicit) and non-stiff (explicit) parts:</span>
<span class="sd">        dy/dt = f_explicit(t, y) + f_implicit(t, y)</span>

<span class="sd">    The scheme advances the solution in two steps:</span>
<span class="sd">        1. Explicit step:  u* = u^n + h * f_explicit(t^n, u^n)</span>
<span class="sd">        2. Implicit step:  u^{n+1} = u* + h * f_implicit(t^{n+1}, u^{n+1})</span>

<span class="sd">    The implicit step is solved via root-finding:</span>
<span class="sd">        R(u^{n+1}) = u^{n+1} - u* - h * f_implicit(t^{n+1}, u^{n+1}) = 0</span>

<span class="sd">    This formulation allows you to:</span>
<span class="sd">    - Use high-order explicit methods (RK4, etc.) for the non-stiff terms</span>
<span class="sd">    - Use implicit methods (BackwardEuler, etc.) for the stiff terms</span>
<span class="sd">    - Avoid overly restrictive time step constraints from stiff terms</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from jax_fno.integrate import (</span>
<span class="sd">            solve_ivp, IMEX, RK4, BackwardEuler,</span>
<span class="sd">            NewtonRaphson, Spectral</span>
<span class="sd">        )</span>

<span class="sd">        def explicit_term(t, u, ...):</span>
<span class="sd">            return ...</span>

<span class="sd">        def implicit_term(t, u, ...):</span>
<span class="sd">            return ...</span>

<span class="sd">        # Instantiate solver</span>
<span class="sd">        solver = IMEX(implicit=BackwardEuler(), explicit=RK4())</span>

<span class="sd">        # Define ODE as a dict</span>
<span class="sd">        ode = {&#39;implicit&#39;: implicit_term, &#39;explicit&#39;: explicit_term}</span>

<span class="sd">        # Solve</span>
<span class="sd">        t, y = solve_ivp(ode, t_span, y0, solver, step_size, args)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">implicit</span><span class="p">:</span> <span class="n">StepperProtocol</span><span class="p">,</span>
        <span class="n">explicit</span><span class="p">:</span> <span class="n">StepperProtocol</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">implicit</span> <span class="o">=</span> <span class="n">implicit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">explicit</span> <span class="o">=</span> <span class="n">explicit</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fun</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]],</span>
        <span class="n">t</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">y</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">h</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Advance one IMEX step.</span>

<span class="sd">        Args:</span>
<span class="sd">            fun: Either a dict with keys &#39;implicit&#39; and &#39;explicit&#39;, or a callable.</span>
<span class="sd">                If a dict, fun[&#39;explicit&#39;](t, y, *args) gives the non-stiff term</span>
<span class="sd">                and fun[&#39;implicit&#39;](t, y, *args) gives the stiff term.</span>
<span class="sd">                If a callable, it&#39;s treated as the implicit term with zero explicit term.</span>
<span class="sd">            t: Current time.</span>
<span class="sd">            y: Current solution.</span>
<span class="sd">            h: Time step size.</span>
<span class="sd">            args: Additional arguments to pass to fun.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Solution at t + h.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Handle dict-based interface</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;explicit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fun</span> <span class="ow">or</span> <span class="s1">&#39;implicit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fun</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;IMEX requires fun to be a dict with &#39;explicit&#39; and &#39;implicit&#39; keys, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;but got keys: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">fun_explicit</span> <span class="o">=</span> <span class="n">fun</span><span class="p">[</span><span class="s1">&#39;explicit&#39;</span><span class="p">]</span>
            <span class="n">fun_implicit</span> <span class="o">=</span> <span class="n">fun</span><span class="p">[</span><span class="s1">&#39;implicit&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If fun is a callable, treat it as implicit-only</span>
            <span class="n">fun_explicit</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="mf">0.0</span>
            <span class="n">fun_implicit</span> <span class="o">=</span> <span class="n">fun</span>

        <span class="c1"># Step 1: Explicit advance to get intermediate state u*</span>
        <span class="c1"># u* = u^n + h * f_explicit(t^n, u^n)</span>
        <span class="n">u_star</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explicit</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">fun_explicit</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

        <span class="c1"># Step 2: Implicit solve from u* to get u^{n+1}</span>
        <span class="c1"># Solve: u^{n+1} = u* + h * f_implicit(t^{n+1}, u^{n+1})</span>
        <span class="c1">#</span>
        <span class="c1"># The implicit stepper expects to solve:</span>
        <span class="c1">#   u^{n+1} = u^n + h * f(t^{n+1}, u^{n+1})</span>
        <span class="c1">#</span>
        <span class="c1"># We substitute u^n -&gt; u* to get the correct equation</span>
        <span class="n">u_next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">implicit</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">fun_implicit</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">u_star</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">u_next</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.IMEX.step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">step</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span></code>

<a href="#jax_fno.integrate.IMEX.step" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Advance one IMEX step.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fun</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.Callable">Callable</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Callable">Callable</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either a dict with keys 'implicit' and 'explicit', or a callable.
If a dict, fun<a href="t, y, *args">'explicit'</a> gives the non-stiff term
and fun<a href="t, y, *args">'implicit'</a> gives the stiff term.
If a callable, it's treated as the implicit term with zero explicit term.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current time.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current solution.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>h</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time step size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to fun.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solution at t + h.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/timesteppers/imex.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fun</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]],</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">h</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Advance one IMEX step.</span>

<span class="sd">    Args:</span>
<span class="sd">        fun: Either a dict with keys &#39;implicit&#39; and &#39;explicit&#39;, or a callable.</span>
<span class="sd">            If a dict, fun[&#39;explicit&#39;](t, y, *args) gives the non-stiff term</span>
<span class="sd">            and fun[&#39;implicit&#39;](t, y, *args) gives the stiff term.</span>
<span class="sd">            If a callable, it&#39;s treated as the implicit term with zero explicit term.</span>
<span class="sd">        t: Current time.</span>
<span class="sd">        y: Current solution.</span>
<span class="sd">        h: Time step size.</span>
<span class="sd">        args: Additional arguments to pass to fun.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Solution at t + h.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Handle dict-based interface</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;explicit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fun</span> <span class="ow">or</span> <span class="s1">&#39;implicit&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fun</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;IMEX requires fun to be a dict with &#39;explicit&#39; and &#39;implicit&#39; keys, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;but got keys: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">fun</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">fun_explicit</span> <span class="o">=</span> <span class="n">fun</span><span class="p">[</span><span class="s1">&#39;explicit&#39;</span><span class="p">]</span>
        <span class="n">fun_implicit</span> <span class="o">=</span> <span class="n">fun</span><span class="p">[</span><span class="s1">&#39;implicit&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If fun is a callable, treat it as implicit-only</span>
        <span class="n">fun_explicit</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="mf">0.0</span>
        <span class="n">fun_implicit</span> <span class="o">=</span> <span class="n">fun</span>

    <span class="c1"># Step 1: Explicit advance to get intermediate state u*</span>
    <span class="c1"># u* = u^n + h * f_explicit(t^n, u^n)</span>
    <span class="n">u_star</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explicit</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">fun_explicit</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="c1"># Step 2: Implicit solve from u* to get u^{n+1}</span>
    <span class="c1"># Solve: u^{n+1} = u* + h * f_implicit(t^{n+1}, u^{n+1})</span>
    <span class="c1">#</span>
    <span class="c1"># The implicit stepper expects to solve:</span>
    <span class="c1">#   u^{n+1} = u^n + h * f(t^{n+1}, u^{n+1})</span>
    <span class="c1">#</span>
    <span class="c1"># We substitute u^n -&gt; u* to get the correct equation</span>
    <span class="n">u_next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">implicit</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">fun_implicit</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">u_star</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">u_next</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.StepperProtocol" class="doc doc-heading">
            <code>jax_fno.integrate.StepperProtocol</code>


<a href="#jax_fno.integrate.StepperProtocol" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>



        <p>Protocol for time-stepping schemes.</p>
<p>Defines the interface for advancing an ODE one time step.
Any class implementing a step() method with this signature can be used
as a time-stepping method in solve_ivp.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/timesteppers/protocol.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@runtime_checkable</span>
<span class="k">class</span><span class="w"> </span><span class="nc">StepperProtocol</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Protocol for time-stepping schemes.</span>

<span class="sd">    Defines the interface for advancing an ODE one time step.</span>
<span class="sd">    Any class implementing a step() method with this signature can be used</span>
<span class="sd">    as a time-stepping method in solve_ivp.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="n">t</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">y</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">h</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Take a single time step.</span>

<span class="sd">        Args:</span>
<span class="sd">            fun: Right-hand side function.</span>
<span class="sd">            t: Current time. Type: 0-dimensional JAX array.</span>
<span class="sd">            y: Current solution.</span>
<span class="sd">            h: Time step size. Type: 0-dimensional JAX array.</span>
<span class="sd">            args: Additional arguments to pass to fun.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Solution at t + h.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.StepperProtocol.step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">step</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span></code>

<a href="#jax_fno.integrate.StepperProtocol.step" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Take a single time step.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fun</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Right-hand side function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current time. Type: 0-dimensional JAX array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current solution.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>h</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time step size. Type: 0-dimensional JAX array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to fun.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solution at t + h.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/timesteppers/protocol.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">h</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">()</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Take a single time step.</span>

<span class="sd">    Args:</span>
<span class="sd">        fun: Right-hand side function.</span>
<span class="sd">        t: Current time. Type: 0-dimensional JAX array.</span>
<span class="sd">        y: Current solution.</span>
<span class="sd">        h: Time step size. Type: 0-dimensional JAX array.</span>
<span class="sd">        args: Additional arguments to pass to fun.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Solution at t + h.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="root-finding-algorithms">Root-finding algorithms<a class="headerlink" href="#root-finding-algorithms" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.NewtonRaphson" class="doc doc-heading">
            <code>jax_fno.integrate.NewtonRaphson</code>


<a href="#jax_fno.integrate.NewtonRaphson" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flax.nnx.Module">Module</span></code></p>



        <p>Newton-Raphson root-finding algorithm.</p>
<p>Iterative update: <span class="arithmatex">\(y \leftarrow y - J^{-1}(y) R(y)\)</span></p>
<p>Implements: RootFinderProtocol</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="jax_fno.integrate.NewtonRaphson.tol">tol</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Convergence tolerance for residual norm</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="jax_fno.integrate.NewtonRaphson.maxiter">maxiter</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of Newton-Raphson iterations</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="jax_fno.integrate.NewtonRaphson.linsolver">linsolver</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Linear solver for inner iterations (default: GMRES)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/rootfinders/newtonraphson.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NewtonRaphson</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Newton-Raphson root-finding algorithm.</span>

<span class="sd">    Iterative update: $y \\leftarrow y - J^{-1}(y) R(y)$</span>

<span class="sd">    Implements: RootFinderProtocol</span>

<span class="sd">    Attributes:</span>
<span class="sd">        tol: Convergence tolerance for residual norm</span>
<span class="sd">        maxiter: Maximum number of Newton-Raphson iterations</span>
<span class="sd">        linsolver: Linear solver for inner iterations (default: GMRES)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
        <span class="n">maxiter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
        <span class="n">linsolver</span><span class="p">:</span> <span class="n">LinearSolverProtocol</span> <span class="o">=</span> <span class="n">GMRES</span><span class="p">()</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tol</span> <span class="o">=</span> <span class="n">tol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span> <span class="o">=</span> <span class="n">maxiter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linsolver</span> <span class="o">=</span> <span class="n">linsolver</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">residual_fn</span><span class="p">:</span> <span class="n">LinearMap</span><span class="p">,</span>
        <span class="n">y_guess</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">jvp_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">JVPConstructor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">jac_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">JacobianConstructor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the root of residual_fn(y) = 0 using Newton-Raphson method.</span>

<span class="sd">        Args:</span>
<span class="sd">            residual_fn: Residual function R(y)</span>
<span class="sd">            y_guess: Initial guess</span>
<span class="sd">            jvp_fn: Matrix-free Jacobian-vector product with</span>
<span class="sd">                signature (y, v) -&gt; J(y)*v</span>
<span class="sd">            jac_fn: Function returning a dense Jacobian matrix with</span>
<span class="sd">                signature y -&gt; J(y)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Solution y</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">jac_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">jvp_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provide either jac_fn OR jvp_fn, not both.&quot;</span><span class="p">)</span>

        <span class="c1"># State carried through Newton iterations</span>
        <span class="n">y_k</span> <span class="o">=</span> <span class="n">y_guess</span>
        <span class="n">r_k</span> <span class="o">=</span> <span class="n">residual_fn</span><span class="p">(</span><span class="n">y_k</span><span class="p">)</span>
        <span class="n">state0</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_k</span><span class="p">,</span> <span class="n">r_k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Define body for a single Newton iteration</span>
        <span class="k">if</span> <span class="n">jac_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Dense mode</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">body_fun</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
                <span class="n">y_k</span><span class="p">,</span> <span class="n">r_k</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">state</span>
                <span class="n">J</span> <span class="o">=</span> <span class="n">jac_fn</span><span class="p">(</span><span class="n">y_k</span><span class="p">)</span>  <span class="c1"># construct dense matrix</span>
                <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linsolver</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="o">-</span><span class="n">r_k</span><span class="p">)</span>
                <span class="n">y_kp1</span> <span class="o">=</span> <span class="n">y_k</span> <span class="o">+</span> <span class="n">delta</span>
                <span class="n">r_kp1</span> <span class="o">=</span> <span class="n">residual_fn</span><span class="p">(</span><span class="n">y_kp1</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">y_kp1</span><span class="p">,</span> <span class="n">r_kp1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">jvp_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Matrix-free mode</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">body_fun</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
                <span class="n">y_k</span><span class="p">,</span> <span class="n">r_k</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">state</span>
                <span class="n">jvp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span> <span class="p">:</span> <span class="n">jvp_fn</span><span class="p">(</span><span class="n">y_k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>  <span class="c1"># define matrix-free operator</span>
                <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linsolver</span><span class="p">(</span><span class="n">jvp</span><span class="p">,</span> <span class="o">-</span><span class="n">r_k</span><span class="p">)</span>
                <span class="n">y_kp1</span> <span class="o">=</span> <span class="n">y_k</span> <span class="o">+</span> <span class="n">delta</span>
                <span class="n">r_kp1</span> <span class="o">=</span> <span class="n">residual_fn</span><span class="p">(</span><span class="n">y_kp1</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">y_kp1</span><span class="p">,</span> <span class="n">r_kp1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must provide either jvp_fn or jac_fn&quot;</span><span class="p">)</span>

        <span class="c1"># Convergence condition</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">cond_fun</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">r_k</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">state</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">r_k</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tol</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">k</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span><span class="p">)</span>

        <span class="n">y_final</span><span class="p">,</span> <span class="n">r_final</span><span class="p">,</span> <span class="n">niters</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">while_loop</span><span class="p">(</span><span class="n">cond_fun</span><span class="p">,</span> <span class="n">body_fun</span><span class="p">,</span> <span class="n">state0</span><span class="p">)</span>

        <span class="c1"># Runtime warning</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">warn_callback</span><span class="p">(</span><span class="n">iters</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">,</span> <span class="n">residual_norm</span><span class="p">,</span> <span class="n">tol</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">iters</span> <span class="o">&gt;=</span> <span class="n">maxiter</span> <span class="ow">and</span> <span class="n">residual_norm</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
                <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;WARNING: Newton-Raphson did not converge within </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">maxiter</span><span class="p">)</span><span class="si">}</span><span class="s2"> iterations.&quot;</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Final residual norm: </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">residual_norm</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">s1</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">s2</span><span class="p">)</span>

        <span class="n">jax</span><span class="o">.</span><span class="n">debug</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
            <span class="n">warn_callback</span><span class="p">,</span> 
            <span class="n">niters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span><span class="p">,</span> 
            <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">r_final</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">tol</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">y_final</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.NewtonRaphson.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">residual_fn</span><span class="p">,</span> <span class="n">y_guess</span><span class="p">,</span> <span class="n">jvp_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jac_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#jax_fno.integrate.NewtonRaphson.__call__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Find the root of residual_fn(y) = 0 using Newton-Raphson method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>residual_fn</code>
            </td>
            <td>
                  <code><span title="jax_fno.integrate.custom_types.LinearMap">LinearMap</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residual function R(y)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_guess</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial guess</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>jvp_fn</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax_fno.integrate.custom_types.JVPConstructor">JVPConstructor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix-free Jacobian-vector product with
signature (y, v) -&gt; J(y)*v</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>jac_fn</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax_fno.integrate.custom_types.JacobianConstructor">JacobianConstructor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function returning a dense Jacobian matrix with
signature y -&gt; J(y)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solution y</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/rootfinders/newtonraphson.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">residual_fn</span><span class="p">:</span> <span class="n">LinearMap</span><span class="p">,</span>
    <span class="n">y_guess</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">jvp_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">JVPConstructor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">jac_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">JacobianConstructor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the root of residual_fn(y) = 0 using Newton-Raphson method.</span>

<span class="sd">    Args:</span>
<span class="sd">        residual_fn: Residual function R(y)</span>
<span class="sd">        y_guess: Initial guess</span>
<span class="sd">        jvp_fn: Matrix-free Jacobian-vector product with</span>
<span class="sd">            signature (y, v) -&gt; J(y)*v</span>
<span class="sd">        jac_fn: Function returning a dense Jacobian matrix with</span>
<span class="sd">            signature y -&gt; J(y)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Solution y</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">jac_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">jvp_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provide either jac_fn OR jvp_fn, not both.&quot;</span><span class="p">)</span>

    <span class="c1"># State carried through Newton iterations</span>
    <span class="n">y_k</span> <span class="o">=</span> <span class="n">y_guess</span>
    <span class="n">r_k</span> <span class="o">=</span> <span class="n">residual_fn</span><span class="p">(</span><span class="n">y_k</span><span class="p">)</span>
    <span class="n">state0</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_k</span><span class="p">,</span> <span class="n">r_k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Define body for a single Newton iteration</span>
    <span class="k">if</span> <span class="n">jac_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Dense mode</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">body_fun</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
            <span class="n">y_k</span><span class="p">,</span> <span class="n">r_k</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">state</span>
            <span class="n">J</span> <span class="o">=</span> <span class="n">jac_fn</span><span class="p">(</span><span class="n">y_k</span><span class="p">)</span>  <span class="c1"># construct dense matrix</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linsolver</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="o">-</span><span class="n">r_k</span><span class="p">)</span>
            <span class="n">y_kp1</span> <span class="o">=</span> <span class="n">y_k</span> <span class="o">+</span> <span class="n">delta</span>
            <span class="n">r_kp1</span> <span class="o">=</span> <span class="n">residual_fn</span><span class="p">(</span><span class="n">y_kp1</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">y_kp1</span><span class="p">,</span> <span class="n">r_kp1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">jvp_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Matrix-free mode</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">body_fun</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
            <span class="n">y_k</span><span class="p">,</span> <span class="n">r_k</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">state</span>
            <span class="n">jvp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span> <span class="p">:</span> <span class="n">jvp_fn</span><span class="p">(</span><span class="n">y_k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>  <span class="c1"># define matrix-free operator</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linsolver</span><span class="p">(</span><span class="n">jvp</span><span class="p">,</span> <span class="o">-</span><span class="n">r_k</span><span class="p">)</span>
            <span class="n">y_kp1</span> <span class="o">=</span> <span class="n">y_k</span> <span class="o">+</span> <span class="n">delta</span>
            <span class="n">r_kp1</span> <span class="o">=</span> <span class="n">residual_fn</span><span class="p">(</span><span class="n">y_kp1</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">y_kp1</span><span class="p">,</span> <span class="n">r_kp1</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must provide either jvp_fn or jac_fn&quot;</span><span class="p">)</span>

    <span class="c1"># Convergence condition</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">cond_fun</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">r_k</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">r_k</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tol</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">k</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span><span class="p">)</span>

    <span class="n">y_final</span><span class="p">,</span> <span class="n">r_final</span><span class="p">,</span> <span class="n">niters</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">while_loop</span><span class="p">(</span><span class="n">cond_fun</span><span class="p">,</span> <span class="n">body_fun</span><span class="p">,</span> <span class="n">state0</span><span class="p">)</span>

    <span class="c1"># Runtime warning</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">warn_callback</span><span class="p">(</span><span class="n">iters</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">,</span> <span class="n">residual_norm</span><span class="p">,</span> <span class="n">tol</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">iters</span> <span class="o">&gt;=</span> <span class="n">maxiter</span> <span class="ow">and</span> <span class="n">residual_norm</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;WARNING: Newton-Raphson did not converge within </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">maxiter</span><span class="p">)</span><span class="si">}</span><span class="s2"> iterations.&quot;</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Final residual norm: </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">residual_norm</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">s1</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">s2</span><span class="p">)</span>

    <span class="n">jax</span><span class="o">.</span><span class="n">debug</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span>
        <span class="n">warn_callback</span><span class="p">,</span> 
        <span class="n">niters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span><span class="p">,</span> 
        <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">r_final</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">tol</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">y_final</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.RootFinderProtocol" class="doc doc-heading">
            <code>jax_fno.integrate.RootFinderProtocol</code>


<a href="#jax_fno.integrate.RootFinderProtocol" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>



        <p>Protocol for root-finding algorithms.</p>
<p>Defines the interface for finding roots of nonlinear equations.
Used by implicit time-stepping schemes to solve the nonlinear systems
that arise from implicit discretization.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/rootfinders/protocol.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@runtime_checkable</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RootFinderProtocol</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Protocol for root-finding algorithms.</span>

<span class="sd">    Defines the interface for finding roots of nonlinear equations.</span>
<span class="sd">    Used by implicit time-stepping schemes to solve the nonlinear systems</span>
<span class="sd">    that arise from implicit discretization.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">residual_fn</span><span class="p">:</span> <span class="n">LinearMap</span><span class="p">,</span>
        <span class="n">y_guess</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">jvp_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">JVPConstructor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">jac_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">JacobianConstructor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the root of residual_fn(y) = 0.</span>

<span class="sd">        Args:</span>
<span class="sd">            residual_fn: Function mapping y -&gt; R(y), where we seek R(y) = 0</span>
<span class="sd">            y_guess: Initial guess for the solution</span>
<span class="sd">            jvp_fn: Optional Jacobian-vector product function (y, v) -&gt; J*v</span>
<span class="sd">            jac_fn: Optional dense Jacobian function y -&gt; J</span>

<span class="sd">        Returns:</span>
<span class="sd">            Solution y such that residual_fn(y)  0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.RootFinderProtocol.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">residual_fn</span><span class="p">,</span> <span class="n">y_guess</span><span class="p">,</span> <span class="n">jvp_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jac_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#jax_fno.integrate.RootFinderProtocol.__call__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Find the root of residual_fn(y) = 0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>residual_fn</code>
            </td>
            <td>
                  <code><span title="jax_fno.integrate.custom_types.LinearMap">LinearMap</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function mapping y -&gt; R(y), where we seek R(y) = 0</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_guess</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial guess for the solution</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>jvp_fn</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax_fno.integrate.custom_types.JVPConstructor">JVPConstructor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional Jacobian-vector product function (y, v) -&gt; J*v</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>jac_fn</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax_fno.integrate.custom_types.JacobianConstructor">JacobianConstructor</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dense Jacobian function y -&gt; J</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solution y such that residual_fn(y)  0</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/rootfinders/protocol.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">residual_fn</span><span class="p">:</span> <span class="n">LinearMap</span><span class="p">,</span>
    <span class="n">y_guess</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">jvp_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">JVPConstructor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">jac_fn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">JacobianConstructor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the root of residual_fn(y) = 0.</span>

<span class="sd">    Args:</span>
<span class="sd">        residual_fn: Function mapping y -&gt; R(y), where we seek R(y) = 0</span>
<span class="sd">        y_guess: Initial guess for the solution</span>
<span class="sd">        jvp_fn: Optional Jacobian-vector product function (y, v) -&gt; J*v</span>
<span class="sd">        jac_fn: Optional dense Jacobian function y -&gt; J</span>

<span class="sd">    Returns:</span>
<span class="sd">        Solution y such that residual_fn(y)  0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="linear-solvers">Linear solvers<a class="headerlink" href="#linear-solvers" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.GMRES" class="doc doc-heading">
            <code>jax_fno.integrate.GMRES</code>


<a href="#jax_fno.integrate.GMRES" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flax.nnx.Module">Module</span></code></p>



        <p>Generalised Minimal Residual (GMRES).</p>
<p>Dispatches to <code>jax.scipy.sparse.linalg.gmres</code>.
Suitable for general non-symmetric systems.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/linsolvers/krylov.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GMRES</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generalised Minimal Residual (GMRES).</span>

<span class="sd">    Dispatches to `jax.scipy.sparse.linalg.gmres`.</span>
<span class="sd">    Suitable for general non-symmetric systems.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tol</span> <span class="o">=</span> <span class="n">tol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span> <span class="o">=</span> <span class="n">maxiter</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">A</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LinearMap</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span> 
        <span class="n">b</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">x0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve A*x = b using GMRES.</span>

<span class="sd">        Args:</span>
<span class="sd">            A: Dense matrix or linear operator with signature x -&gt; A*x</span>
<span class="sd">            b: Right-hand side vector</span>
<span class="sd">            x0: Initial guess vector</span>

<span class="sd">        Returns:</span>
<span class="sd">            Approximate solution x</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">solution</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">jax_sparse</span><span class="o">.</span><span class="n">gmres</span><span class="p">(</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tol</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.GMRES.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#jax_fno.integrate.GMRES.__call__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Solve A*x = b using GMRES.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>A</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="jax_fno.integrate.custom_types.LinearMap">LinearMap</span>, <span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dense matrix or linear operator with signature x -&gt; A*x</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Right-hand side vector</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x0</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial guess vector</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Approximate solution x</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/linsolvers/krylov.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">A</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LinearMap</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span> 
    <span class="n">b</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">x0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve A*x = b using GMRES.</span>

<span class="sd">    Args:</span>
<span class="sd">        A: Dense matrix or linear operator with signature x -&gt; A*x</span>
<span class="sd">        b: Right-hand side vector</span>
<span class="sd">        x0: Initial guess vector</span>

<span class="sd">    Returns:</span>
<span class="sd">        Approximate solution x</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solution</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">jax_sparse</span><span class="o">.</span><span class="n">gmres</span><span class="p">(</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tol</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.CG" class="doc doc-heading">
            <code>jax_fno.integrate.CG</code>


<a href="#jax_fno.integrate.CG" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flax.nnx.Module">Module</span></code></p>



        <p>Conjugate Gradients (CG).</p>
<p>Dispatches to <code>jax.scipy.sparse.linalg.cg</code>.
Only suitable for symmetric and positive-definite systems.</p>
<p>Implements: LinearSolverProtocol</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="jax_fno.integrate.CG.tol">tol</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Convergence tolerance for residual norm</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="jax_fno.integrate.CG.maxiter">maxiter</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of iterations</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/linsolvers/krylov.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CG</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conjugate Gradients (CG).</span>

<span class="sd">    Dispatches to `jax.scipy.sparse.linalg.cg`.</span>
<span class="sd">    Only suitable for symmetric and positive-definite systems.</span>

<span class="sd">    Implements: LinearSolverProtocol</span>

<span class="sd">    Attributes:</span>
<span class="sd">        tol: Convergence tolerance for residual norm</span>
<span class="sd">        maxiter: Maximum number of iterations</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tol</span> <span class="o">=</span> <span class="n">tol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span> <span class="o">=</span> <span class="n">maxiter</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">A</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LinearMap</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span> 
        <span class="n">b</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">x0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve A*x = b.</span>

<span class="sd">        Args:</span>
<span class="sd">            A: Dense matrix or linear operator with signature x -&gt; A*x</span>
<span class="sd">            b: Right-hand side vector</span>
<span class="sd">            x0: Initial guess vector</span>

<span class="sd">        Returns:</span>
<span class="sd">            Approximate solution x</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">solution</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">jax_sparse</span><span class="o">.</span><span class="n">cg</span><span class="p">(</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tol</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.CG.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#jax_fno.integrate.CG.__call__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Solve A*x = b.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>A</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="jax_fno.integrate.custom_types.LinearMap">LinearMap</span>, <span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dense matrix or linear operator with signature x -&gt; A*x</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Right-hand side vector</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x0</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial guess vector</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Approximate solution x</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/linsolvers/krylov.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">A</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LinearMap</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span> 
    <span class="n">b</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">x0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve A*x = b.</span>

<span class="sd">    Args:</span>
<span class="sd">        A: Dense matrix or linear operator with signature x -&gt; A*x</span>
<span class="sd">        b: Right-hand side vector</span>
<span class="sd">        x0: Initial guess vector</span>

<span class="sd">    Returns:</span>
<span class="sd">        Approximate solution x</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solution</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">jax_sparse</span><span class="o">.</span><span class="n">cg</span><span class="p">(</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tol</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.BiCGStab" class="doc doc-heading">
            <code>jax_fno.integrate.BiCGStab</code>


<a href="#jax_fno.integrate.BiCGStab" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flax.nnx.Module">Module</span></code></p>



        <p>Stabilised Biconjugate Gradients (BiCGStab).</p>
<p>Dispatches to <code>jax.scipy.sparse.linalg.bicgstab</code>.
Suitable for non-symmetric systems.</p>
<p>Implements: LinearSolverProtocol</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="jax_fno.integrate.BiCGStab.tol">tol</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Convergence tolerance for residual norm</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="jax_fno.integrate.BiCGStab.maxiter">maxiter</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of iterations</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/linsolvers/krylov.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BiCGStab</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stabilised Biconjugate Gradients (BiCGStab).</span>

<span class="sd">    Dispatches to `jax.scipy.sparse.linalg.bicgstab`.</span>
<span class="sd">    Suitable for non-symmetric systems.</span>

<span class="sd">    Implements: LinearSolverProtocol</span>

<span class="sd">    Attributes:</span>
<span class="sd">        tol: Convergence tolerance for residual norm</span>
<span class="sd">        maxiter: Maximum number of iterations</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tol</span> <span class="o">=</span> <span class="n">tol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span> <span class="o">=</span> <span class="n">maxiter</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">A</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LinearMap</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span> 
        <span class="n">b</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">x0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve A*x = b.</span>

<span class="sd">        Args:</span>
<span class="sd">            A: Dense matrix or linear operator with signature x -&gt; A*x</span>
<span class="sd">            b: Right-hand side vector</span>
<span class="sd">            x0: Initial guess vector</span>

<span class="sd">        Returns:</span>
<span class="sd">            Approximate solution x</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">solution</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">jax_sparse</span><span class="o">.</span><span class="n">bicgstab</span><span class="p">(</span>
            <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tol</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.BiCGStab.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#jax_fno.integrate.BiCGStab.__call__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Solve A*x = b.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>A</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="jax_fno.integrate.custom_types.LinearMap">LinearMap</span>, <span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dense matrix or linear operator with signature x -&gt; A*x</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Right-hand side vector</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x0</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial guess vector</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Approximate solution x</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/linsolvers/krylov.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">A</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LinearMap</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span> 
    <span class="n">b</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">x0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve A*x = b.</span>

<span class="sd">    Args:</span>
<span class="sd">        A: Dense matrix or linear operator with signature x -&gt; A*x</span>
<span class="sd">        b: Right-hand side vector</span>
<span class="sd">        x0: Initial guess vector</span>

<span class="sd">    Returns:</span>
<span class="sd">        Approximate solution x</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solution</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">jax_sparse</span><span class="o">.</span><span class="n">bicgstab</span><span class="p">(</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tol</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxiter</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.DirectDense" class="doc doc-heading">
            <code>jax_fno.integrate.DirectDense</code>


<a href="#jax_fno.integrate.DirectDense" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="flax.nnx.Module">Module</span></code></p>



        <p>Direct solver for dense linear systems.</p>
<p>Dispatches to <code>jax.numpy.linalg.solve</code>.
Only suitable for small systems where the Jacobian is provided explicitly.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/linsolvers/direct.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DirectDense</span><span class="p">(</span><span class="n">nnx</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Direct solver for dense linear systems.</span>

<span class="sd">    Dispatches to `jax.numpy.linalg.solve`.</span>
<span class="sd">    Only suitable for small systems where the Jacobian is provided explicitly.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">A</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LinearMap</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span> 
        <span class="n">b</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">x0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve A*x = b.</span>

<span class="sd">        Args:</span>
<span class="sd">            A: Dense matrix</span>
<span class="sd">            b: Right-hand side vector</span>
<span class="sd">            x0: Ignored (kept for interface compatibility). Can be None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Solution x</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If A is a callable (linear operator) instead of a matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;DirectSolve requires a dense matrix, not a linear operator. &quot;</span>
                <span class="s2">&quot;Please provide the Jacobian as a dense matrix (jac_fn), &quot;</span>
                <span class="s2">&quot;or use an iterative solver (GMRES, CG, BiCGStab).&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.DirectDense.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#jax_fno.integrate.DirectDense.__call__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Solve A*x = b.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>A</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="jax_fno.integrate.custom_types.LinearMap">LinearMap</span>, <span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dense matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Right-hand side vector</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x0</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ignored (kept for interface compatibility). Can be None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solution x</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If A is a callable (linear operator) instead of a matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/linsolvers/direct.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">A</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LinearMap</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span> 
    <span class="n">b</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">x0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve A*x = b.</span>

<span class="sd">    Args:</span>
<span class="sd">        A: Dense matrix</span>
<span class="sd">        b: Right-hand side vector</span>
<span class="sd">        x0: Ignored (kept for interface compatibility). Can be None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Solution x</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If A is a callable (linear operator) instead of a matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;DirectSolve requires a dense matrix, not a linear operator. &quot;</span>
            <span class="s2">&quot;Please provide the Jacobian as a dense matrix (jac_fn), &quot;</span>
            <span class="s2">&quot;or use an iterative solver (GMRES, CG, BiCGStab).&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><p>:: jax_fno.integrate.Spectral</p>


<div class="doc doc-object doc-class">



<h1 id="jax_fno.integrate.LinearSolverProtocol" class="doc doc-heading">
            <code>jax_fno.integrate.LinearSolverProtocol</code>


<a href="#jax_fno.integrate.LinearSolverProtocol" class="headerlink" title="Permanent link">&para;</a></h1>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.Protocol">Protocol</span></code></p>



        <p>Protocol for linear solvers.</p>
<p>Defines the interface for solving linear systems of the form A*x = b.
Any class implementing a <strong>call</strong>() method with this signature can be used
as a linear solver in implicit integration schemes.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/jax_fno/integrate/linsolvers/protocol.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@runtime_checkable</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LinearSolverProtocol</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Protocol for linear solvers.</span>

<span class="sd">    Defines the interface for solving linear systems of the form A*x = b.</span>
<span class="sd">    Any class implementing a __call__() method with this signature can be used</span>
<span class="sd">    as a linear solver in implicit integration schemes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">A</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LinearMap</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span> 
        <span class="n">b</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">x0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve the linear system A*x = b.</span>

<span class="sd">        Args:</span>
<span class="sd">            A: Dense matrix or linear operator with signature x -&gt; A*x</span>
<span class="sd">            b: Right-hand side vector</span>
<span class="sd">            x0: Initial guess vector</span>

<span class="sd">        Returns:</span>
<span class="sd">            Solution vector x such that A*x  b</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="jax_fno.integrate.LinearSolverProtocol.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#jax_fno.integrate.LinearSolverProtocol.__call__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Solve the linear system A*x = b.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>A</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="jax_fno.integrate.custom_types.LinearMap">LinearMap</span>, <span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dense matrix or linear operator with signature x -&gt; A*x</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Right-hand side vector</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x0</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="jax.Array">Array</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial guess vector</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solution vector x such that A*x  b</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/jax_fno/integrate/linsolvers/protocol.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">A</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LinearMap</span><span class="p">,</span> <span class="n">Array</span><span class="p">],</span> 
    <span class="n">b</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">x0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve the linear system A*x = b.</span>

<span class="sd">    Args:</span>
<span class="sd">        A: Dense matrix or linear operator with signature x -&gt; A*x</span>
<span class="sd">        b: Right-hand side vector</span>
<span class="sd">        x0: Initial guess vector</span>

<span class="sd">    Returns:</span>
<span class="sd">        Solution vector x such that A*x  b</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>